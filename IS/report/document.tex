\documentclass[12pt,a4paper]{report}


\usepackage{listings, color}
\usepackage{xcolor}
% Language & Encoding
\usepackage{inputenc}
\usepackage[T1]{fontenc}
\usepackage{babel}

% Formatting
\usepackage{setspace}       % For line spacing
\usepackage{geometry}       % For page margins
\geometry{margin=1in}

% Extra Packages
% \usepackage{indentfirst}
\usepackage{changepage, titlesec}
\usepackage{booktabs}
\usepackage{array}
\usepackage{float}
\usepackage{graphicx}       % For including images
\usepackage{hyperref}       % For clickable links & ToC
\usepackage{tocloft}        % ToC customization (optional)
\usepackage{fancyhdr}       % Headers & footers
\usepackage{amsmath,amssymb} % Math support
\usepackage{caption}        % Better captions
\usepackage{lipsum}         % Dummy text (for demo)


\usepackage{xepersian}
\settextfont{B Nazanin}
\setlatintextfont{Times New Roman} 



\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}





% Setup for hyperlinks
\hypersetup{
	colorlinks=true,
	linkcolor=blue,
	urlcolor=cyan,
	citecolor=red
}

\lstdefinestyle{mystyle}{
	backgroundcolor=\color{backcolour},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\ttfamily\footnotesize,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2
}

\lstset{style=mystyle}

% Header and Footer style
\pagestyle{fancy}
\fancyhf{}
\rhead{\leftmark}
\lhead{گزارش کارآموزی}
\cfoot{\thepage}


\begin{document}
	
	% Title Page
	\begin{titlepage}
		\centering
		{\scshape\LARGE دانشگاه صنعتی اصفهان \par}
		\vspace{1cm}
		{\scshape\Large مرکز ابررایانش \par  }
		\vspace{1.5cm}
		{\huge\bfseries گزارش کارآموزی \par}
		\vspace{2cm}
		
		\begin{center}
			\includegraphics[width=0.3\linewidth]{iut_logo}
		\end{center}
		
		\begin{center}
			\includegraphics[width=0.7\linewidth]{hpc_logo}
		\end{center}
		
		{\Large نویسنده: مجتبی ملائی \par}
		\vfill
		استادکارآموزی: دکتر فاطمه دلدار \par
		\par سرپرست کارآموزی: آقای محمد صالح محمدی
		\vfill
		{\large \today\par}
	\end{titlepage}
	
	% Abstract
	\begin{abstract}
		من و همکارانم در این دوره کارآموزی ضمن آشنایی با مرکز ابررایانش و افراد متخصص شاغل در این مرکز با استفاده از ابزار های \lr{kubernetes}، \lr{kubervirt} و \lr{ceph} بستری ایجاد کردیم تا بتوانیم ماشین های مجازی ویندوز را با هدف در دسترس بودن کامل\footnote{\lr{Highly available}} و با قابلیت هایی مانند تخصیص منابع به صورت برخط و امکان خودکار سازی\footnote{\lr{automation}} به صورت ایمن در اختیار مصرف‌کنندگان  قرار دهیم.
	\end{abstract}
	
	% Table of Contents
	\tableofcontents
	%\listoffigures
	%\listoftables
	\newpage
	
	% Chapters
	\chapter{معرفی}
	\section{پیش‌زمینه من}
	من کارآموزی‌ام را در بعد از ترم ششم آغاز کردم. در این دوران با برخی از گرایش‌ها، زمینه ها و مسیر های مختلف در حوزه کامپیوتر آشنا شدم که از جمله آنها برنامه نویسی سمت سرور\footnote{\lr{back-end}}، امنیت سایبری، شبکه و هوش مصنوعی بود. در این میان به فناوری های سمت  سرور مانند \lr{Linux} علاقه‌مند شدم و این موضوع باعث شد تا تصمیم بگیرم که کارآموزی‌ام را در حوزه های مربوط به سرور ها بگذرانم.
	\section{مرکز ابررایانش شیخ بهائی}
	شبکه ملی محاسبات ابری در سال ۱۳۸۸ با هدف ارائه خدمات کامل و جامع محاسباتی به صنایع و مراکز علمی و تحقیقاتی کشور و با حمایت معاونت علمی و فناوری ریاست جمهوری افتتاح شد.
	
	مرکز ملی محاسبات ابری \footnote{\lr{ National High Performance Computing Center}}(\lr{NHPCC}) به عنوان یکی از چندین مرکز ابررایانه کشور، در آن زمان بخشی از این طرح ملی را در قالب تأسیس مرکز ملی ابررایانه شیخ بهایی اجرا کرد.
	
	تمهیدات در نظر گرفته شده در مرکز ملی محاسبات ابری شیخ بهایی به گونه‌ای است که امکانات سخت‌افزاری و نرم‌افزاری جامع و کامل و همچنین خدمات آموزشی و مشاوره‌ای فنی و تخصصی برای استفاده بهینه (در محل یا از راه دور) در دسترس باشد. 
	\subsection{منظور از یک خوشه \lr{HPC} چیست؟}
	
	محاسبات با کارایی بالا یا \lr{HPC}\footnote{\lr{High Performance Computing}} هنر داشتن مجموعه‌ای از گره‌های پردازشی قدرتمند است که به عنوان یک خوشه (یا گروه‌هایی از آنها) به هم متصل شده‌اند تا مجموعه داده‌های عظیم یا مسائل ریاضی پیچیده چند بعدی را به صورت موازی و در سریع‌ترین زمان ممکن حل کنند. بنابراین \lr{HPC} در مورد محاسبات است.
	
	همچنین ممکن است اصطلاح ابررایانه را بشنوید که مترادف خوشه \lr{HPC} (یا گروه‌هایی از آنها) است. این نام بیشتر به دیدگاه سخت‌افزاری و قدرت آن اشاره دارد که معمولاً به عنوان یک واحد ممیز شناور به نام فلاپ (مانند ترافلاپس، پتافلاپس و ...) محاسبه می‌شود.
	
	به عنوان مثال، می‌توانید دانش‌آموزی را در نظر بگیرید که یک کد بزرگ (نوشته شده در بیش از هزاران خط) دارد و اگر تمایل داشته باشد کد خود را در لپ‌تاپ شخصی خود اجرا کند، چند سال طول می‌کشد تا پردازش تمام شود و نتیجه نهایی را ببیند؟ بنابراین اگر کد خود را به ابررایانه منتقل کنند، در مدت زمان بسیار کوتاهی به نتایج دست می‌یابد.
	\subsection{معماری}
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.7\linewidth]{hpc_arch}
		\caption{اجزای یک خوشه}
		\label{fig:hpcarch}
	\end{figure}
	معمولاً یک خوشه پایه از این اجزای اصلی تشکیل شده است:
	\begin{itemize}
		\item[$\bullet$] 
		یک گره ورود (گره سر)
		\item[$\bullet$] 
		انواع گره‌های محاسباتی
		\item[$\bullet$] 
		یک فضای ذخیره‌سازی مشترک توزیع‌شده
		\item[$\bullet$] 
		سرورهای \lr{GPU} (برای بهره‌مندی از محاسبات گرافیکی عظیم)
		\item[$\bullet$] 
		یک سوئیچ \lr{Infiniband} برای اتصال گره‌ها
		\item[$\bullet$] 
		یک زمان‌بند کار و یک سیستم صف‌بندی
		\item[$\bullet$] 
		یک گره انتقال
		\item[$\bullet$] 
		یک گره پساپردازش
	\end{itemize}
	\subsection{نحوه کار}
		کاربران به گره ورود(گره سر) وارد می‌شوند و فایل‌های ورودی خود را آپلود می‌کنند. سپس کارهای خود را به زمانبند ارسال می‌کنند و در صف انتظار قرار می‌گیرند. سپس زمانبند شروع به ارسال کارهای آنها به تمام گره‌های محاسباتی دیگری که کاربر مجاز به دسترسی به آنها است، می‌کند.
		
	\section{پروژه}
	در برخی از موارد مرکز نیاز دارد تا سرور های مجازی ویندوزی را در اختیار مشتریان خود بگذارد. دلیل استفاده از ویندوز راحتی و سادگی بیشتر برای دانشجویان و مشتریانی است که رشته و تخصص آن‌ها در حوزه کامپیوتر نیست و نیاز دارند تا از قدرت محاسباتی مرکز استفاده کنند. برای این افراد کار با سیستم عامل \lr{Linux} که به طور معمول در خوشه ها استفاده میشود بسیار دشوار است. 
	
	نیاز دیگر این بود که اختصاص سرور ها به مشتریان به صورت خودکار و با کمترین مداخله ممکن از طرف یک نیروی انسانی صورت بگیرد. به همین دلیل استفاده از ابزار هایی مانند \lr{Proxmox} که در این مرکز استفاده می‌شود ممکن نبود.
	
	از طرفی در دسترس بودن و سلامتی این سرور ها مهم ترین رکن آن‌ها است. در واقع این پردازش ها به دلیل زمان‌بر بودن آن‌ها از اهمیت خاصی برخوردار هستند. به عنوان مثال در صورتی که سرور میزبان دچار خطا شود، سرور مجازی ویندوز نیز از کار می‌افتد و تمام منابع و زمانی که برای پردازش استفاده شده بود به هدر می‌رود. از دید یک مصرف کننده این اتفاق کاملا غیر قابل تحمل است زیرا که ممکن است مصرف کننده زمان لازم برای این اجرای دوباره این پردازش را نداشته باشد.
	
	هدف این پروژه برطرف سازی این مشکلات و نیاز ها بود. در کنار این‌ها قابلیت هایی مانند تخصیص منابع به صورت زنده،‌ اضافه کردن و حذف دیسک ها به صورت زنده و برقرار سازی سطح مناسبی از امنیت از اهداف مهم دیگر این پروژه بودند.
	
	
	\chapter{آماده سازی}
	
	\section{آماده سازی کامپیوتر‌ها}
	\section{آماده سازی سرور‌ها}
	\lipsum[4]
	\chapter{ارکستراسیون}
	\section{\lr{Kubernetes}}
	\lipsum[5-12]
	
	\chapter{پیاده‌سازی شبکه}
	\section{\lr{calico}}
	\section{\lr{multus}}
	\section{\lr{macvtap}}
	\section{\lr{bridge}}
	\section{\lr{kubemacpool}}
	\lipsum[7]
	
	\chapter{بستر مجازی سازی در \lr{k8s}}
	\section{\lr{Kubevirt}}
	\section{منابع ماشین ها}
	\section{انتقال زنده}
	\section{تخصیص منابع به صورت زنده}
	\lipsum[8]
	
	\chapter{\lr{Windows image}}
	\section{گرفتن اطلاعات}
	\section{تنطیمات اضافی}
	\lipsum[9]
	
	\chapter{\lr{kubevirt-manager}}
	\chapter{نظارت}
	\section{\lr{Prometheus}}
	\section{\lr{Graphana}}
	\lipsum[10]
	
	% References
%	\begin{thebibliography}{99}
%		\bibitem{ref1} Author, \textit{Book or Paper Title}, Publisher, Year.
%		\bibitem{ref2} Another Author, ``Article Title'', \textit{Journal}, Year.
%	\end{thebibliography}
	
	% Appendix
	\appendix
	\chapter{اطلاعات اضافی}
	\lipsum[11]
	
\end{document}
